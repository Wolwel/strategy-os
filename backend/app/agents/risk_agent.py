from app.services.llm_service import get_llm_response


async def run_risk_assessment(framing: str, market: str, competitors: str, finance: str) -> str:
    """
    Risk Assessment Agent - –æ–∫—Ä–µ–º–∏–π –∞–≥–µ–Ω—Ç –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–æ—ó –æ—Ü—ñ–Ω–∫–∏ —Ä–∏–∑–∏–∫—ñ–≤.
    –í—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ Advocate —Ç–∏–º, —â–æ —Ñ–æ–∫—É—Å—É—î—Ç—å—Å—è –Ω–∞ –¢–ê–ë–õ–ò–ß–ù–Ü–ô –æ—Ü—ñ–Ω—Ü—ñ —Ä–∏–∑–∏–∫—ñ–≤,
    –∞ –Ω–µ –Ω–∞ –∫—Ä–∏—Ç–∏—Ü—ñ –ª–æ–≥—ñ–∫–∏.
    """
    print("   [Risk Agent] Analyzing risks with structured framework...")

    prompt = f"""
–¢–∏ ‚Äî Risk Assessment Agent. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏, –æ—Ü—ñ–Ω–∏—Ç–∏ —Ç–∞ –∑–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ –º—ñ—Ç–∏–≥–∞—Ü—ñ—ó –¥–ª—è –≤—Å—ñ—Ö —Ç–∏–ø—ñ–≤ —Ä–∏–∑–∏–∫—ñ–≤.

–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ—î–∫—Ç—É:
1) –Ü–¥–µ—è/Brief: {framing}
2) –†–∏–Ω–æ–∫: {market}
3) –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–∏: {competitors}
4) –§—ñ–Ω–∞–Ω—Å–∏: {finance}

### –§–û–†–ú–ê–¢ –í–Ü–î–ü–û–í–Ü–î–Ü (Markdown):

## ‚öñÔ∏è –ú–∞—Ç—Ä–∏—Ü—è —Ä–∏–∑–∏–∫—ñ–≤

| # | –†–∏–∑–∏–∫ | –ö–∞—Ç–µ–≥–æ—Ä—ñ—è | –ô–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å | –í–ø–ª–∏–≤ | –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç | –ú—ñ—Ç–∏–≥–∞—Ü—ñ—è |
|---|-------|-----------|-------------|-------|-----------|-----------|
| 1 | [–û–ø–∏—Å] | üî¥ –†–∏–Ω–∫–æ–≤–∏–π / üü† –û–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏–π / üü° –§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π / üîµ –†–µ–≥—É–ª—è—Ç–æ—Ä–Ω–∏–π / üü£ –¢–µ—Ö–Ω—ñ—á–Ω–∏–π | –ù–∏–∑—å–∫–∞/–°–µ—Ä–µ–¥–Ω—è/–í–∏—Å–æ–∫–∞ | –ù–∏–∑—å–∫–∏–π/–°–µ—Ä–µ–¥–Ω—ñ–π/–ö—Ä–∏—Ç–∏—á–Ω–∏–π | 1-5 | [–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –∑–∞—Ö—ñ–¥] |

(–ú—ñ–Ω—ñ–º—É–º 5-8 —Ä–∏–∑–∏–∫—ñ–≤, –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–∏—Ö –∑–∞ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–æ–º)

## üõë Showstoppers (–∫—Ä–∏—Ç–∏—á–Ω—ñ —Ä–∏–∑–∏–∫–∏)
- –†–∏–∑–∏–∫–∏ –∑ –ô–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å=–í–∏—Å–æ–∫–∞ AND –í–ø–ª–∏–≤=–ö—Ä–∏—Ç–∏—á–Ω–∏–π
- –Ø–∫—â–æ —Ç–∞–∫–∏—Ö –Ω–µ–º–∞—î ‚Äî –Ω–∞–ø–∏—Å–∞—Ç–∏ "–ö—Ä–∏—Ç–∏—á–Ω–∏—Ö showstoppers –Ω–µ –≤–∏—è–≤–ª–µ–Ω–æ"

## üéØ Top-3 —Ä–∏–∑–∏–∫–∏ –¥–ª—è –Ω–µ–≥–∞–π–Ω–æ—ó —É–≤–∞–≥–∏
1. **[–ù–∞–∑–≤–∞]**: –ß–æ–º—É –≤–∞–∂–ª–∏–≤–æ + –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π action item
2. **[–ù–∞–∑–≤–∞]**: ...
3. **[–ù–∞–∑–≤–∞]**: ...

## üìã –ü–ª–∞–Ω –º—ñ—Ç–∏–≥–∞—Ü—ñ—ó (–ø–µ—Ä—à—ñ 30 –¥–Ω—ñ–≤)
| –¢–∏–∂–¥–µ–Ω—å | –î—ñ—è | –í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|---------|-----|----------------|-----------|
| 1 | ... | ... | ... |
| 2 | ... | ... | ... |
| 3-4 | ... | ... | ... |

## üéöÔ∏è –ó–∞–≥–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞ —Ä–∏–∑–∏–∫—É
- **Risk Score:** X/10 (1=–º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π, 10=–∫—Ä–∏—Ç–∏—á–Ω–∏–π)
- **Confidence:** X% (–Ω–∞—Å–∫—ñ–ª—å–∫–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ –≤ –æ—Ü—ñ–Ω—Ü—ñ)
- **Verdict:** üü¢ –ü—Ä–∏–π–Ω—è—Ç–Ω–∏–π / üü° –ü–æ—Ç—Ä–µ–±—É—î —É–≤–∞–≥–∏ / üî¥ –í–∏—Å–æ–∫–∏–π

‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û:
- –ù–µ –≤–∏–≥–∞–¥—É–π —Ä–∏–∑–∏–∫–∏ ‚Äî –±–∞–∑—É–π—Å—è –Ω–∞ –Ω–∞–¥–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- –Ø–∫—â–æ –¥–∞–Ω–∏—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ ‚Äî –≤–∫–∞–∂–∏ —Ü–µ —è–≤–Ω–æ
- –ú—ñ—Ç–∏–≥–∞—Ü—ñ—ó –º–∞—é—Ç—å –±—É—Ç–∏ –ö–û–ù–ö–†–ï–¢–ù–ò–ú–ò —ñ —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–∏–º–∏
"""

    return await get_llm_response(prompt, temperature=0.25, agent="risk_agent")